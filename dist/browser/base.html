<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>学习笔记</title><meta name="description" content="学习笔记">
    <link rel="preload" href="/Blog/assets/style-0b9ce7ad.css" as="style"><link rel="stylesheet" href="/Blog/assets/style-0b9ce7ad.css">
    <link rel="modulepreload" href="/Blog/assets/app-dadefc50.js"><link rel="modulepreload" href="/Blog/assets/framework-96b046e1.js"><link rel="modulepreload" href="/Blog/assets/base.html-825d79b6.js"><link rel="modulepreload" href="/Blog/assets/base.html-95aff8c0.js"><link rel="prefetch" href="/Blog/assets/index.html-a56817af.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-2c940357.js" as="script"><link rel="prefetch" href="/Blog/assets/webpack.html-7f8bfdc3.js" as="script"><link rel="prefetch" href="/Blog/assets/link.html-df5993d3.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-53fde12e.js" as="script"><link rel="prefetch" href="/Blog/assets/scss.html-59132c0d.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-c1f9b1d6.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-eddcf1a3.js" as="script"><link rel="prefetch" href="/Blog/assets/monitor.html-9ee054fa.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-2be58e9d.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-1cee374f.js" as="script"><link rel="prefetch" href="/Blog/assets/reg.html-e11b7e5e.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-dd1172af.js" as="script"><link rel="prefetch" href="/Blog/assets/uniApp.html-fd096210.js" as="script"><link rel="prefetch" href="/Blog/assets/cli.html-febf7e36.js" as="script"><link rel="prefetch" href="/Blog/assets/link.html-b1389815.js" as="script"><link rel="prefetch" href="/Blog/assets/other.html-43ce6cbe.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-4ff46826.js" as="script"><link rel="prefetch" href="/Blog/assets/surf.html-38c00729.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-c14b016f.js" as="script"><link rel="prefetch" href="/Blog/assets/hooks.html-e5fda826.js" as="script"><link rel="prefetch" href="/Blog/assets/router.html-a446123a.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-8d14bd31.js" as="script"><link rel="prefetch" href="/Blog/assets/git.html-35808dbd.js" as="script"><link rel="prefetch" href="/Blog/assets/vscode.html-23624dc4.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-e20366d5.js" as="script"><link rel="prefetch" href="/Blog/assets/link.html-3d7e5ea0.js" as="script"><link rel="prefetch" href="/Blog/assets/other.html-f306e44b.js" as="script"><link rel="prefetch" href="/Blog/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/Blog/assets/index.html-77dae3f5.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-59d48e40.js" as="script"><link rel="prefetch" href="/Blog/assets/webpack.html-1d963a55.js" as="script"><link rel="prefetch" href="/Blog/assets/link.html-2fc49689.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-e8dbb10a.js" as="script"><link rel="prefetch" href="/Blog/assets/scss.html-4d17fd00.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-3404eaad.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-bb894de3.js" as="script"><link rel="prefetch" href="/Blog/assets/monitor.html-341257f1.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-29a78c29.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-9ec68a4b.js" as="script"><link rel="prefetch" href="/Blog/assets/reg.html-cc9128be.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-9ac172cb.js" as="script"><link rel="prefetch" href="/Blog/assets/uniApp.html-973c11cf.js" as="script"><link rel="prefetch" href="/Blog/assets/cli.html-22c6eb04.js" as="script"><link rel="prefetch" href="/Blog/assets/link.html-eff77e1d.js" as="script"><link rel="prefetch" href="/Blog/assets/other.html-ee804908.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-d1fa5699.js" as="script"><link rel="prefetch" href="/Blog/assets/surf.html-5ecb64b6.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-9208a7ab.js" as="script"><link rel="prefetch" href="/Blog/assets/hooks.html-b8cea301.js" as="script"><link rel="prefetch" href="/Blog/assets/router.html-49a3cfac.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-b4316d20.js" as="script"><link rel="prefetch" href="/Blog/assets/git.html-c3ed4b91.js" as="script"><link rel="prefetch" href="/Blog/assets/vscode.html-6ec94ab9.js" as="script"><link rel="prefetch" href="/Blog/assets/base.html-fe2fce60.js" as="script"><link rel="prefetch" href="/Blog/assets/link.html-f7eb057a.js" as="script"><link rel="prefetch" href="/Blog/assets/other.html-1a054d84.js" as="script"><link rel="prefetch" href="/Blog/assets/404.html-46166703.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/Blog/" class=""><!----><span class="site-name">学习笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/Blog/README.md" class="sidebar-item sidebar-heading" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">浏览器相关 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/Blog/browser/base.md" class="sidebar-item active" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a href="/Blog/browser/link.md" class="sidebar-item" aria-label="链接相关"><!--[--><!--]--> 链接相关 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">HTML <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/html/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">CSS <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/css/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a href="/Blog/css/scss.md" class="sidebar-item" aria-label="SASS"><!--[--><!--]--> SASS <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">JavaScript <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/javascript/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a href="/Blog/javascript/reg.md" class="sidebar-item" aria-label="正则表达式"><!--[--><!--]--> 正则表达式 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">NPM <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/npm/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">NodeJs <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/nodejs/link.md" class="sidebar-item" aria-label="链接相关"><!--[--><!--]--> 链接相关 <!--[--><!--]--></a><!----></li><li><a href="/Blog/nodejs/other.md" class="sidebar-item" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">TypeScript <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/typescript/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a href="/Blog/typescript/link.md" class="sidebar-item" aria-label="链接相关"><!--[--><!--]--> 链接相关 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Vue <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/vue/other.md" class="sidebar-item" aria-label="其他"><!--[--><!--]--> 其他 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">React <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/react/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a href="/Blog/react/hooks.md" class="sidebar-item" aria-label="Hooks"><!--[--><!--]--> Hooks <!--[--><!--]--></a><!----></li><li><a href="/Blog/react/router.md" class="sidebar-item" aria-label="Router"><!--[--><!--]--> Router <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">构建工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/buildTools/webpack.md" class="sidebar-item" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">小程序 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/miniProgram/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a href="/Blog/miniProgram/uniApp.md" class="sidebar-item" aria-label="uni-app"><!--[--><!--]--> uni-app <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Electron <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/electron/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/tools/vscode.md" class="sidebar-item" aria-label="VSCODE"><!--[--><!--]--> VSCODE <!--[--><!--]--></a><!----></li><li><a href="/Blog/tools/git.md" class="sidebar-item" aria-label="GIT"><!--[--><!--]--> GIT <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">前端架构 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/framework/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a href="/Blog/framework/monitor.md" class="sidebar-item" aria-label="监控"><!--[--><!--]--> 监控 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">测试 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/test/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">算法 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/algorithm/base.md" class="sidebar-item" aria-label="基础"><!--[--><!--]--> 基础 <!--[--><!--]--></a><!----></li><li><a class="external-link sidebar-item" href="https://github.com/youngyangyang04/leetcode-master" rel="noopener noreferrer" target="_blank" aria-label="LeetCode 刷题攻略"><!--[--><!--]--> LeetCode 刷题攻略 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a><!----></li><li><a class="external-link sidebar-item" href="https://github.com/hustcc/JS-Sorting-Algorithm" rel="noopener noreferrer" target="_blank" aria-label="十大排序算法"><!--[--><!--]--> 十大排序算法 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">杂项 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/other/surf.md" class="sidebar-item" aria-label="科学上网"><!--[--><!--]--> 科学上网 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><nav class="table-of-contents"><ul><li><a href="#浏览器渲染原理">浏览器渲染原理</a></li><li><a href="#浏览器存储">浏览器存储</a></li><li><a href="#浏览器缓存">浏览器缓存</a></li><li><a href="#获取-url-中的参数">获取 URL 中的参数</a></li></ul></nav><h3 id="浏览器渲染原理" tabindex="-1"><a class="header-anchor" href="#浏览器渲染原理" aria-hidden="true">#</a> 浏览器渲染原理</h3><h4 id="浏览器内核" tabindex="-1"><a class="header-anchor" href="#浏览器内核" aria-hidden="true">#</a> 浏览器内核</h4><img src="/Blog/assets/render-f3f6063b.jpg" alt="render.jpg" width="80%"><ul><li><strong>GUI 渲染线程</strong>：GUI 渲染线程负责渲染浏览器界面，解析 HTML，CSS，构建 DOM 树和 RenderObject 树，布局和绘制等。当界面 需要重绘（Repaint）或由于某种操作引发回流（Reflow）时，该线程就会执行。</li><li><strong>JavaScript 引擎线程</strong>: JavaScript 引擎线程主要负责解析 JavaScript 脚本并运行相关代码。 JavaScript 引擎在一个 Tab 页 （Renderer 进程）中无论什么时候都只有一个 JavaScript 线程在运行 JavaScript 程序。需要提起一点就是，GUI 线程与 JavaScript 引擎线程是互斥的，这也是就是为什么 JavaScript 操作时间过长，会造成页面渲染不连贯，导致页面出现阻塞的原理。</li><li><strong>事件触发线程</strong>：当一个事件被触发时该线程会把事件添加到待处理队列的队尾，等待 JavaScript 引擎的处理。 通常 JavaScript 引擎是单线程的，所以这些事件都会排队等待 JS 执行。</li><li><strong>定时器触发器</strong>： 我们日常使用的 setInterval 和 setTimeout 就在该线程中，原因可能就是：由于 JS 引擎是单线程的，如果处 于阻塞线程状态就会影响记时的准确，所以需要通过单独的线程来记时并触发响应的事件这样子更为合理。</li><li><strong>Http 请求线程</strong>： 在 XMLHttpRequest 在连接后是通过浏览器新开一个线程请求，这个线程就 Http 请求线程，它将检测到状态变 更时，如果设置有回调函数，异步线程就产生状态变更事件放到 JavaScript 引擎的处理队列中等待处理。</li></ul><h4 id="渲染机制" tabindex="-1"><a class="header-anchor" href="#渲染机制" aria-hidden="true">#</a> 渲染机制</h4><ol><li>处理 HTML 并构建 DOM 树。</li><li>处理 CSS 构建 CSSOM 树。</li><li>将 DOM 与 CSSOM 合并成一个渲染树。</li><li>根据渲染树来布局，计算每个节点的位置。</li><li>调用 GPU 绘制，合成图层，显示在屏幕上。</li></ol><p>webkit 内核浏览器渲染流程如下图所示：</p><p><img src="/Blog/assets/render-898fdc39.png" alt=""></p><p>在构建 CSSOM 树时，会阻塞渲染，直至 CSSOM 树构建完成。并且构建 CSSOM 树是一个十分消耗性能的过程，所以应该尽量保证层级扁 平，减少过度层叠，越是具体的 CSS 选择器，执行速度越慢。</p><p>当 HTML 解析到 script 标签时，会暂停构建 DOM，完成后才会从暂停的地方重新开始。也就是说，如果你想首屏渲染的越快，就越不应 该在首屏就加载 JS 文件。并且 CSS 也会影响 JS 的执行，只有当解析完样式表才会执行 JS，所以也可以认为这种情况下，CSS 也会暂 停构建 DOM。</p><h4 id="load-和-domcontentloaded-区别" tabindex="-1"><a class="header-anchor" href="#load-和-domcontentloaded-区别" aria-hidden="true">#</a> Load 和 DOMContentLoaded 区别</h4><ul><li>Load 事件触发代表页面中的 DOM，CSS，JS，图片已经全部加载完毕。</li><li>DOMContentLoaded 事件触发代表初始的 HTML 被完全加载和解析，不需要等待 CSS，JS，图片加载。</li></ul><h4 id="图层" tabindex="-1"><a class="header-anchor" href="#图层" aria-hidden="true">#</a> 图层</h4><p>一般来说，可以把普通文档流看成一个图层。特定的属性可以生成一个新的图层。不同的图层渲染互不影响，所以对于某些频繁需要渲染 的建议单独生成一个新图层，提高性能。但也不能生成过多的图层，会引起反作用。</p><p>通过以下几个常用属性可以生成新图层：</p><ul><li>3D 变换：translate3d、translateZ</li><li>will-change</li><li>video、iframe 标签</li><li>通过动画实现的 opacity 动画转换</li><li>position: fixed</li></ul><h4 id="重绘-repaint-和回流-reflow" tabindex="-1"><a class="header-anchor" href="#重绘-repaint-和回流-reflow" aria-hidden="true">#</a> 重绘（Repaint）和回流（Reflow）</h4><ul><li><p><strong>重绘</strong>：当我们对 DOM 的修改导致了样式的变化、却并未影响其几何属性（比如修改了颜色或背景色）时，浏览器不需重新计算元 素的几何属性、直接为该元素绘制新的样式（跳过了上图所示的回流环节）予给元素并重新绘制它，这个过程称为重绘。</p></li><li><p><strong>回流</strong>：当我们对 DOM 的修改引发了 DOM 几何尺寸的变化（比如修改元素的宽、高或隐藏元素等）时，浏览器需要重新计算元素的 几何属性（其他元素的几何属性和位置也会因此受到影响），然后再将计算的结果绘制出来。这个过程就是回流（也叫重排）</p></li><li><p>回流必定会发生重绘，重绘不一定会引发回流</p><p>触发回流的属性和方法： clientWidth、clientHeight、clientTop、clientLeft、offsetWidth、offsetHeight、offsetTop、offsetLeft、scrollWidth、scrollHeight、scrollTop、scrollLeft、scrollIntoView()、scrollIntoViewIfNeeded()、getComputedStyle()、getBoundingClientRect()、scrollTo()</p></li></ul><h4 id="async-和-defer" tabindex="-1"><a class="header-anchor" href="#async-和-defer" aria-hidden="true">#</a> async 和 defer</h4><ul><li><p>浏览器在解析 HTML 的时候，如果遇到一个没有任何属性的 script 标签，就会暂停解析，先发送网络请求获取该 JS 脚本的代码内容 ，然后让 JS 引擎执行该代码，当代码执行完毕后恢复解析。整个过程如下图所示：</p><p><img src="/Blog/assets/1-d9e8b792.jpg" alt=""></p></li><li><p>当浏览器遇到带有 async 属性的 script 时，请求该脚本的网络请求是异步的，不会阻塞浏览器解析 HTML，一旦网络请求回来之后， 如果此时 HTML 还没有解析完，浏览器会暂停解析，先让 JS 引擎执行代码，执行完毕后再进行解析，图示如下：</p><p><img src="/Blog/assets/2-4da4091f.jpg" alt=""></p></li><li><p>如果在 JS 脚本请求回来之前，HTML 已经解析完毕了，那就啥事没有，立即执行 JS 代码，如下图所示：</p></li></ul><p><img src="/Blog/assets/3-2221ffed.jpg" alt=""></p><ul><li><p>浏览器遇到带有 defer 属性的 script 时，获取该脚本的网络请求也是异步的，不会阻塞浏览器解析 HTML，一旦网络请求回来之后， 如果此时 HTML 还没有解析完，浏览器不会暂停解析并执行 JS 代码，而是等待 HTML 解析完毕再执行 JS 代码，图示如下：</p><p><img src="/Blog/assets/4-e702fb98.jpg" alt=""></p><table><thead><tr><th>script 标签</th><th>js 执行顺序</th><th>是否阻塞解析 HTML</th></tr></thead><tbody><tr><td>&lt;script&gt;</td><td>在 HTML 中的顺序</td><td>阻塞</td></tr><tr><td>&lt;script async&gt;</td><td>网络请求返回顺序</td><td>可能阻塞，也可能不阻塞</td></tr><tr><td>&lt;script defer&gt;</td><td>在 HTML 中的顺序</td><td>阻塞</td></tr></tbody></table></li></ul><h4 id="性能优化策略" tabindex="-1"><a class="header-anchor" href="#性能优化策略" aria-hidden="true">#</a> 性能优化策略</h4><ul><li><p><strong>JS 优化</strong>：&lt;script&gt; 标签加上 defer 属性 和 async 属性用于在不阻塞页面文档解析的前提下，控制脚本的下载和执行。</p><ul><li>defer 属性： 用于开启新的线程下载脚本文件，并使脚本在文档解析完成后执行。</li><li>async 属性： HTML5 新增属性，用于异步下载脚本文件，下载完毕立即解释执行代码。</li></ul></li><li><p><strong>CSS 优化</strong>： <link> 标签的 rel 属性 中的属性值设置为 preload 能够让你在你的 HTML 页面中可以指明哪些资源是在页面加 载 完成后即刻需要的,最优的配置加载顺序，提高渲染性能</p></li></ul><div class="custom-container tip"><p class="custom-container-title">总结</p><ol><li>浏览器工作流程：构建 DOM -&gt; 构建 CSSOM -&gt; 构建渲染树 -&gt; 布局 -&gt; 绘制。</li><li>CSSOM 会阻塞渲染，只有当 CSSOM 构建完毕后才会进入下一个阶段构建渲染树。</li><li>通常情况下 DOM 和 CSSOM 是并行构建的，但是当浏览器遇到一个不带 defer 或 async 属性的 script 标签时，DOM 构建将暂停， 如果此时又恰巧浏览器尚未完成 CSSOM 的下载和构建，由于 JavaScript 可以修改 CSSOM，所以需要等 CSSOM 构建完毕后再执行 JS，最后才重新 DOM 构建。</li><li><a href="https://juejin.cn/post/6847902222349500430" target="_blank" rel="noopener noreferrer">参考链接<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ol></div><h3 id="浏览器存储" tabindex="-1"><a class="header-anchor" href="#浏览器存储" aria-hidden="true">#</a> 浏览器存储</h3><table><thead><tr><th>特性</th><th>cookie</th><th>localStorage</th><th>sessionStorage</th><th>indexDB</th></tr></thead><tbody><tr><td>数据生命周期</td><td>一般由服务器生成，可以设置过期时间</td><td>手动清理</td><td>页面关闭自动清理</td><td>手动清理</td></tr><tr><td>数据存储大小</td><td>4KB</td><td>5MB</td><td>5MB</td><td>无限制</td></tr><tr><td>与服务端通信</td><td>每次都会携带 header 中，对于请求影响性能</td><td>-</td><td>-</td><td>-</td></tr></tbody></table><div class="custom-container tip"><p class="custom-container-title">总结</p><ol><li>Cookie 的本职工作并非本地存储，而是“维持状态”。</li><li>Web Storage 定义了两个对象用于存储数据：sessionStorage 和 localStorage。前者用于严格保存浏览器一次会话期间的数据，因 为数据会在浏览器关闭时被删除。后者用于会话之外持久保存数据。</li><li>IndexedDB 是类似于 SQL 数据库的结构化数据存储机制。不同的是，IndexedDB 存储的是对象，而不是数据表。</li></ol></div><h3 id="浏览器缓存" tabindex="-1"><a class="header-anchor" href="#浏览器缓存" aria-hidden="true">#</a> 浏览器缓存</h3><p><img src="/Blog/assets/cache-d36ca74c.png" alt="浏览器缓存"></p><h4 id="缓存位置" tabindex="-1"><a class="header-anchor" href="#缓存位置" aria-hidden="true">#</a> 缓存位置</h4><ul><li><strong>Service Worker</strong>：浏览器独立线程，可以控制缓存哪些文件、如何匹配缓存、如何读取缓存，并且缓存是持续性的。首先需要先注 册 Service Worker，然后监听到 install 事件以后就可以缓存需要的文件，那么在下次用户访问的时候就可以通过拦截请求的方式查 询是否存在缓存，存在缓存的话就可以直接读取缓存文件，否则就去请求数据</li><li><strong>Memory Cache</strong>：内存中的缓存，关闭 Tab 页面，内存中的缓存也就被释放了。内存缓存在缓存资源时并不关心返回资源的 HTTP 缓存头 Cache-Control 是什么值，同时资源的匹配也并非仅仅是对 URL 做匹配，还可能会对 Content-Type，CORS 等其他特征做校验 。</li><li><strong>Disk Cache</strong>：硬盘中的缓存</li><li><strong>Push Cache</strong>：推送缓存，是 HTTP/2 中的内容，当以上三种缓存都没有命中时，它才会被使用。它只在会话（Session）中存在， 一旦会话结束就被释放，并且缓存时间也很短暂</li></ul><h4 id="强缓存" tabindex="-1"><a class="header-anchor" href="#强缓存" aria-hidden="true">#</a> 强缓存</h4><p>不会向服务器发送请求，直接从缓存中读取资源，强缓存可以通过设置两种 HTTP Header 实现：Expires 和 Cache-Control。</p><ul><li><strong>Expires</strong>：缓存过期时间，用来指定资源到期的时间，是服务器端的具体的时间点。如果修改了本地时间，可能会造成缓存失效</li><li><strong>Cache-Control</strong>：主要用于控制网页缓存 <ul><li><strong>public</strong>：所有内容都将被缓存（客户端和代理服务器都可缓存）</li><li><strong>private</strong>：所有内容只有客户端可以缓存，Cache-Control 的默认取值</li><li><strong>no-cache</strong>：客户端缓存内容，是否使用缓存则需要经过协商缓存来验证决定。表示不使用 Cache-Control 的缓存控制方式做前 置验证，而是使用 Etag 或者 Last-Modified 字段来控制缓存。需要注意的是，no-cache 这个名字有一点误导。设置了 no-cache 之后，并不是说浏览器就不再缓存数据，只是浏览器在使用缓存数据时，需要先确认一下数据是否还跟服务器保持一致。</li><li><strong>no-store</strong>：所有内容都不会被缓存，即不使用强制缓存，也不使用协商缓存</li><li><strong>max-age</strong>：max-age=60，表示缓存内容将在 60s 后失效</li><li><strong>s-maxage</strong>：同 max-age 作用一样，只在代理服务器中生效（比如 CDN 缓存）。比如当 s-maxage=60 时，在这 60 秒中，即使 更新了 CDN 的内容，浏览器也不会进行请求。max-age 用于普通缓存，而 s-maxage 用于代理缓存。s-maxage 的优先级高于 max-age。如果存在 s-maxage，则会覆盖掉 max-age 和 Expires header。</li><li><strong>max-stale</strong>：能容忍的最大过期时间。max-stale 指令标示了客户端愿意接收一个已经过期了的响应。如果指定了 max-stale 的 值，则最大容忍时间为对应的秒数。如果没有指定，那么说明浏览器愿意接收任何 age 的响应（age 表示响应由源站生成或确认的 时间与当前时间的差值）。</li><li><strong>min-fresh</strong>：能够容忍的最小新鲜度。min-fresh 标示了客户端不愿意接受新鲜度不多于当前的 age 加上 min-fresh 设定的时 间之和的响应。</li></ul></li><li>Expires 是 http1.0 的产物，Cache-Control 是 http1.1 的产物，两者同时存在的话，Cache-Control 优先级高于 Expires；在某些 不支持 HTTP1.1 的环境下，Expires 就会发挥用处。所以 Expires 其实是过时的产物，现阶段它的存在只是一种兼容性的写法。</li></ul><h4 id="协商缓存" tabindex="-1"><a class="header-anchor" href="#协商缓存" aria-hidden="true">#</a> 协商缓存</h4><p>协商缓存就是强制缓存失效后，浏览器携带缓存标识向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程，主要有以下两 种情况：</p><ul><li>协商缓存生效，返回 304 和 Not Modified</li><li>协商缓存失效，返回 200 和请求结果</li></ul><table><thead><tr><th>消息报头</th><th>示例</th><th>类型</th><th>作用</th></tr></thead><tbody><tr><td>Last-Modified</td><td>Mon, 15 Aug 2016 03:56:47 GMT</td><td>响应</td><td>告诉浏览器这个资源最后的修改时间。服务器将资源传递给客户端时，会将资源最后更改的时间以“Last-Modified: GMT”的形式加在实体首部上一起返回给客户端【只能精确到秒级，如果某些文件在 1 秒钟以内，被修改多次的话，它将不能准确标注文件的修改时间】</td></tr><tr><td>If-Modified-Since</td><td>Mon, 15 Aug 2016 03:56:47 GMT</td><td>请求</td><td>其值为上次响应头的 Last-Modified 值，再次向 web 服务器请求时带上头 If-Modified-Since。web 服务器收到请求后发现有头 If-Modified-Since 则与被请求资源的最后修改时间进行比对。若最后修改时间较新，说明资源又被改动过，则响应整片资源内容（写在响应消息包体内），包括更新 Last-Modified 的值，HTTP 200；若最后修改时间较旧，说明资源无新修改，则响应 HTTP 304(无需请求，节省浏览)，告知浏览器继续使用所保存的 cache</td></tr><tr><td>ETag</td><td>&quot;fd56273325a2114818df4f29a628226d&quot;</td><td>响应</td><td>告诉浏览器当前资源在服务器的唯一标识符（生成规则由服务器决定）</td></tr><tr><td>If-None-Match</td><td>&quot;fd56273325a2114818df4f29a628226d&quot;</td><td>请求</td><td>当资源过期时（使用 Cache-Control 标识的 max-age），发现资源具有 Etage 声明，则再次向 web 服务器请求时带上头 If-None-Match（Etag 的值）。web 服务器收到请求后发现有头 If-None-Match 则与被请求资源的相应校验串进行比对，决定返回 200 或 304</td></tr></tbody></table><h4 id="缓存机制" tabindex="-1"><a class="header-anchor" href="#缓存机制" aria-hidden="true">#</a> 缓存机制</h4><p>强制缓存优先于协商缓存进行，若强制缓存(Expires 和 Cache-Control)生效则直接使用缓存，若不生效则进行协商缓存(Last-Modified / If-Modified-Since 和 Etag / If-None-Match)，协商缓存由服务器决定是否使用缓存，若协商缓存失效，那么代表该请求的缓存失效 ，返回 200，重新返回资源和缓存标识，再存入浏览器缓存中；生效则返回 304，继续使用缓存。</p><h4 id="常用缓存策略" tabindex="-1"><a class="header-anchor" href="#常用缓存策略" aria-hidden="true">#</a> 常用缓存策略</h4><ul><li><p><strong>频繁变动的资源</strong>：对于频繁变动的资源，首先需要使用 Cache-Control: no-cache 使浏览器每次都请求服务器，然后配合 ETag 或者 Last-Modified 来验证资源是否有效。这样的做法虽然不能节省请求数量，但是能显著减少响应数据大小。</p></li><li><p><strong>不常变化的资源</strong>：通常在处理这类资源时，给它们的 Cache-Control 配置一个很大的 max-age=31536000 (一年)，这样浏览器之 后请求相同的 URL 会命中强制缓存。而为了解决更新的问题，就需要在文件名(或者路径)中添加 hash， 版本号等动态字符，之后更 改动态字符，从而达到更改引用 URL 的目的，让之前的强制缓存失效 (其实并未立即失效，只是不再使用了而已)。在线提供的类库 ( 如 jquery-3.3.1.min.js, lodash.min.js 等) 均采用这个模式。</p></li></ul><h4 id="用户行为对浏览器缓存的影响" tabindex="-1"><a class="header-anchor" href="#用户行为对浏览器缓存的影响" aria-hidden="true">#</a> 用户行为对浏览器缓存的影响</h4><ul><li><strong>打开网页，地址栏输入地址</strong>： 查找 disk cache 中是否有匹配。如有则使用；如没有则发送网络请求。</li><li><strong>普通刷新 (F5)</strong>：因为 TAB 并没有关闭，因此 memory cache 是可用的，会被优先使用(如果匹配的话)。其次才是 disk cache。</li><li><strong>强制刷新 (Ctrl + F5)</strong>：浏览器不使用缓存，因此发送的请求头部均带有 Cache-control: no-cache(为了兼容，还带了 Pragma: no-cache),服务器直接返回 200 和最新内容。</li></ul><h4 id="不能缓存的请求" tabindex="-1"><a class="header-anchor" href="#不能缓存的请求" aria-hidden="true">#</a> 不能缓存的请求</h4><ul><li>post 请求无法被缓存。</li><li>需要根据 cookie、认证信息等决定输入内容的动态请求不能被缓存。</li><li>http 响应头中不包含 Last-Modified/ETag，也不包含 Cache-Control/Expiress 的请求无法被缓存。</li><li>http 信息头明确设置 Cache-Control:no-cache,pragma:no-cache 或 Cache-Control:max-age=0 浏览器不缓存时。</li></ul><h3 id="获取-url-中的参数" tabindex="-1"><a class="header-anchor" href="#获取-url-中的参数" aria-hidden="true">#</a> 获取 URL 中的参数</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getURLParameters</span> <span class="token operator">=</span> <span class="token parameter">url</span> <span class="token operator">=&gt;</span>
  <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([^?=&amp;]+)(=([^&amp;]*))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>v<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;=&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&#39;=&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Examples</span>

<span class="token function">getURLParameters</span><span class="token punctuation">(</span><span class="token string">&#39;google.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {}</span>

<span class="token function">getURLParameters</span><span class="token punctuation">(</span><span class="token string">&#39;http://url.com/page?name=Adam&amp;surname=Smith&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {name: &#39;Adam&#39;, surname: &#39;Smith&#39;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://www.30secondsofcode.org/js/s/get-url-parameters" target="_blank" rel="noopener noreferrer">参考链接<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: wangrenjie86@gmail.com">fc86jie</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/Blog/assets/app-dadefc50.js" defer></script>
  </body>
</html>
